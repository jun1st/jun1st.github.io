{"expireTime":9007200866307601000,"key":"transformer-remark-markdown-ast-04e1b173782bd177bcd1cd917563015f-gatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-autolink-headersgatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypantsgatsby-remark-external-links-","val":{"type":"root","children":[{"type":"paragraph","children":[{"type":"text","value":"Java 中的 Map 实际上并不属于 Java Collection，因为他并没有继承自 Collection 接口。 在 Java 中，Map 是一个接口","position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":80,"offset":80},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":80,"offset":80},"indent":[]}},{"type":"blockquote","children":[{"type":"paragraph","children":[{"type":"text","value":"An object that maps keys to values.  A map cannot contain duplicate keys;\neach key can map to at most one value.","position":{"start":{"line":4,"column":5,"offset":86},"end":{"line":5,"column":43,"offset":202},"indent":[5]}}],"position":{"start":{"line":4,"column":5,"offset":86},"end":{"line":5,"column":43,"offset":202},"indent":[5]}}],"position":{"start":{"line":4,"column":1,"offset":82},"end":{"line":5,"column":43,"offset":202},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"AbstractMap 实现 Map 接口，是 Java 中所有 Map 实现的基类。","position":{"start":{"line":7,"column":1,"offset":204},"end":{"line":7,"column":44,"offset":247},"indent":[]}}],"position":{"start":{"line":7,"column":1,"offset":204},"end":{"line":7,"column":44,"offset":247},"indent":[]}},{"type":"blockquote","children":[{"type":"paragraph","children":[{"type":"text","value":"This class provides a skeletal implementation of the {@code Map}\ninterface, to minimize the effort required to implement this interface.","position":{"start":{"line":9,"column":5,"offset":253},"end":{"line":10,"column":76,"offset":393},"indent":[5]}}],"position":{"start":{"line":9,"column":5,"offset":253},"end":{"line":10,"column":76,"offset":393},"indent":[5]}}],"position":{"start":{"line":9,"column":1,"offset":249},"end":{"line":10,"column":76,"offset":393},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"Java 中常用的 Map 有 HashMap， LinkedHashMap， TreeMap， 这个和 Set 类似。","position":{"start":{"line":12,"column":1,"offset":395},"end":{"line":12,"column":61,"offset":455},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":395},"end":{"line":12,"column":61,"offset":455},"indent":[]}},{"type":"paragraph","children":[{"type":"html","title":null,"url":"diagram.jpg","alt":"diagram","position":{"start":{"line":14,"column":1,"offset":457},"end":{"line":14,"column":24,"offset":480},"indent":[]},"value":"\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/fbc9883d7a0970929bfaf0570b936095/c06f5/diagram.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 129.05405405405406%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAaABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHuZqNIgoij/8QAGRAAAgMBAAAAAAAAAAAAAAAAEBEAASBB/9oACAEBAAEFAox2wtf/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAY/Ak//xAAcEAACAgIDAAAAAAAAAAAAAAAAARExECEgQXH/2gAIAQEAAT8hdFO8b8CCohMwNSLXD//aAAwDAQACAAMAAAAQ4Pf/AP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EAB4QAAICAgIDAAAAAAAAAAAAAAERACExgSBBUWGR/9oACAEBAAE/ECRF4gIMWGMXAWHLWSe4YiifqlAt7nSH5iFvUBEHvh//2Q=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"diagram\"\n        title=\"\"\n        src=\"/static/fbc9883d7a0970929bfaf0570b936095/1c72d/diagram.jpg\"\n        srcset=\"/static/fbc9883d7a0970929bfaf0570b936095/a80bd/diagram.jpg 148w,\n/static/fbc9883d7a0970929bfaf0570b936095/1c91a/diagram.jpg 295w,\n/static/fbc9883d7a0970929bfaf0570b936095/1c72d/diagram.jpg 590w,\n/static/fbc9883d7a0970929bfaf0570b936095/a8a14/diagram.jpg 885w,\n/static/fbc9883d7a0970929bfaf0570b936095/fbd2c/diagram.jpg 1180w,\n/static/fbc9883d7a0970929bfaf0570b936095/c06f5/diagram.jpg 1668w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    "}],"position":{"start":{"line":14,"column":1,"offset":457},"end":{"line":14,"column":24,"offset":480},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#hashmap","title":null,"data":{"hProperties":{"aria-hidden":true,"class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"HashMap","position":{"start":{"line":17,"column":4,"offset":486},"end":{"line":17,"column":11,"offset":493},"indent":[]}}],"position":{"start":{"line":17,"column":1,"offset":483},"end":{"line":17,"column":11,"offset":493},"indent":[]},"data":{"id":"hashmap","htmlAttributes":{"id":"hashmap"},"hProperties":{"id":"hashmap"}}},{"type":"blockquote","children":[{"type":"paragraph","children":[{"type":"text","value":"Hash table based implementation of the {@code Map} interface.  This\nimplementation provides all of the optional map operations, and permits\n{@code null} values and the {@code null} key.  (The {@code HashMap}\nclass is roughly equivalent to {@code Hashtable}, except that it is\nunsynchronized and permits nulls.)  This class makes no guarantees as to\nthe order of the map; in particular, it does not guarantee that the order\nwill remain constant over time.","position":{"start":{"line":19,"column":3,"offset":497},"end":{"line":25,"column":34,"offset":963},"indent":[3,3,3,3,3,3]}}],"position":{"start":{"line":19,"column":3,"offset":497},"end":{"line":25,"column":34,"offset":963},"indent":[3,3,3,3,3,3]}}],"position":{"start":{"line":19,"column":1,"offset":495},"end":{"line":25,"column":34,"offset":963},"indent":[1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"在源码的开头注释就写了 HashMap 和 Hashtable 的区别，","position":{"start":{"line":27,"column":1,"offset":965},"end":{"line":27,"column":37,"offset":1001},"indent":[]}}],"position":{"start":{"line":27,"column":1,"offset":965},"end":{"line":27,"column":37,"offset":1001},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"非线程安全的","position":{"start":{"line":29,"column":6,"offset":1008},"end":{"line":29,"column":12,"offset":1014},"indent":[]}}],"position":{"start":{"line":29,"column":6,"offset":1008},"end":{"line":29,"column":12,"offset":1014},"indent":[]}}],"position":{"start":{"line":29,"column":1,"offset":1003},"end":{"line":29,"column":12,"offset":1014},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"key 和 value 都允许是 Null","position":{"start":{"line":30,"column":6,"offset":1020},"end":{"line":30,"column":27,"offset":1041},"indent":[]}}],"position":{"start":{"line":30,"column":6,"offset":1020},"end":{"line":30,"column":27,"offset":1041},"indent":[]}}],"position":{"start":{"line":30,"column":1,"offset":1015},"end":{"line":30,"column":27,"offset":1041},"indent":[]}}],"position":{"start":{"line":29,"column":1,"offset":1003},"end":{"line":30,"column":27,"offset":1041},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"HashMap 是以 key 的哈希值作为key的值来存储的，他能提供 O(N) 级别的访问效率。 看一下源码，put 的大致思路是：","position":{"start":{"line":32,"column":1,"offset":1043},"end":{"line":32,"column":68,"offset":1110},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":1043},"end":{"line":32,"column":68,"offset":1110},"indent":[]}},{"type":"html","lang":"java","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">    <span class=\"token keyword\">public</span> <span class=\"token class-name\">V</span> <span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">K</span> key<span class=\"token punctuation\">,</span> <span class=\"token class-name\">V</span> value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">putVal</span><span class=\"token punctuation\">(</span><span class=\"token function\">hash</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> <span class=\"token function\">hash</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Object</span> key<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">int</span> h<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>key <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token number\">0</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>h <span class=\"token operator\">=</span> key<span class=\"token punctuation\">.</span><span class=\"token function\">hashCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span>h <span class=\"token operator\">>>></span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">/**\n     * Implements Map.put and related methods.\n     *\n     * @param hash hash for key\n     * @param key the key\n     * @param value the value to put\n     * @param onlyIfAbsent if true, don't change existing value\n     * @param evict if false, the table is in creation mode.\n     * @return previous value, or null if none\n     */</span>\n    <span class=\"token keyword\">final</span> <span class=\"token class-name\">V</span> <span class=\"token function\">putVal</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> hash<span class=\"token punctuation\">,</span> <span class=\"token class-name\">K</span> key<span class=\"token punctuation\">,</span> <span class=\"token class-name\">V</span> value<span class=\"token punctuation\">,</span> <span class=\"token keyword\">boolean</span> onlyIfAbsent<span class=\"token punctuation\">,</span>\n                   <span class=\"token keyword\">boolean</span> evict<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> tab<span class=\"token punctuation\">;</span> <span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> p<span class=\"token punctuation\">;</span> <span class=\"token keyword\">int</span> n<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// 如果 table 没有初始化，那就初始化一下</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>tab <span class=\"token operator\">=</span> table<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>n <span class=\"token operator\">=</span> tab<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n            n <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>tab <span class=\"token operator\">=</span> <span class=\"token function\">resize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// 计算index，并对 null 做处理</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>p <span class=\"token operator\">=</span> tab<span class=\"token punctuation\">[</span>i <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>n <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> hash<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\n            tab<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">newNode</span><span class=\"token punctuation\">(</span>hash<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token class-name\">Node</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span> e<span class=\"token punctuation\">;</span> <span class=\"token class-name\">K</span> k<span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">// 节点存在</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>hash <span class=\"token operator\">==</span> hash <span class=\"token operator\">&amp;&amp;</span>\n                <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>k <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> key <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>key <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span> key<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                e <span class=\"token operator\">=</span> p<span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">// 节点是树节点</span>\n            <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>p <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">TreeNode</span><span class=\"token punctuation\">)</span>\n                e <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TreeNode</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">K</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">V</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">)</span>p<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">putTreeVal</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> tab<span class=\"token punctuation\">,</span> hash<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">// 节点是链表</span>\n            <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> binCount <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>binCount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>e <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>next<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                        p<span class=\"token punctuation\">.</span>next <span class=\"token operator\">=</span> <span class=\"token function\">newNode</span><span class=\"token punctuation\">(</span>hash<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>binCount <span class=\"token operator\">>=</span> TREEIFY_THRESHOLD <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// -1 for 1st</span>\n                            <span class=\"token function\">treeifyBin</span><span class=\"token punctuation\">(</span>tab<span class=\"token punctuation\">,</span> hash<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>hash <span class=\"token operator\">==</span> hash <span class=\"token operator\">&amp;&amp;</span>\n                        <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>k <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> key <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>key <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span> key<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                    p <span class=\"token operator\">=</span> e<span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// existing mapping for key</span>\n                <span class=\"token class-name\">V</span> oldValue <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>onlyIfAbsent <span class=\"token operator\">||</span> oldValue <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\n                    e<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span>\n                <span class=\"token function\">afterNodeAccess</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">return</span> oldValue<span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">++</span>modCount<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">++</span>size <span class=\"token operator\">></span> threshold<span class=\"token punctuation\">)</span>\n            <span class=\"token function\">resize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">afterNodeInsertion</span><span class=\"token punctuation\">(</span>evict<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":35,"column":1,"offset":1113},"end":{"line":102,"column":4,"offset":3474},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"这个代码，功能复杂，大致步骤是这样：","position":{"start":{"line":104,"column":1,"offset":3476},"end":{"line":104,"column":19,"offset":3494},"indent":[]}}],"position":{"start":{"line":104,"column":1,"offset":3476},"end":{"line":104,"column":19,"offset":3494},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"检查是否需要初始化和是否需要扩容","position":{"start":{"line":106,"column":4,"offset":3499},"end":{"line":106,"column":20,"offset":3515},"indent":[]}}],"position":{"start":{"line":106,"column":4,"offset":3499},"end":{"line":106,"column":20,"offset":3515},"indent":[]}}],"position":{"start":{"line":106,"column":1,"offset":3496},"end":{"line":106,"column":20,"offset":3515},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"计算下标 (n-1) & hash, 如果不存在，则直接赋值","position":{"start":{"line":107,"column":4,"offset":3519},"end":{"line":107,"column":34,"offset":3549},"indent":[]}}],"position":{"start":{"line":107,"column":4,"offset":3519},"end":{"line":107,"column":34,"offset":3549},"indent":[]}}],"position":{"start":{"line":107,"column":1,"offset":3516},"end":{"line":107,"column":34,"offset":3549},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"如果存在，获取已存在的值，并且考虑是链表还是树，","position":{"start":{"line":108,"column":4,"offset":3553},"end":{"line":108,"column":28,"offset":3577},"indent":[]}}],"position":{"start":{"line":108,"column":4,"offset":3553},"end":{"line":108,"column":28,"offset":3577},"indent":[]}}],"position":{"start":{"line":108,"column":1,"offset":3550},"end":{"line":108,"column":28,"offset":3577},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"如果是链表，检查下是否需要转换成红黑树结构","position":{"start":{"line":109,"column":4,"offset":3581},"end":{"line":109,"column":25,"offset":3602},"indent":[]}}],"position":{"start":{"line":109,"column":4,"offset":3581},"end":{"line":109,"column":25,"offset":3602},"indent":[]}}],"position":{"start":{"line":109,"column":1,"offset":3578},"end":{"line":109,"column":25,"offset":3602},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"替换旧的值","position":{"start":{"line":110,"column":4,"offset":3606},"end":{"line":110,"column":9,"offset":3611},"indent":[]}}],"position":{"start":{"line":110,"column":4,"offset":3606},"end":{"line":110,"column":9,"offset":3611},"indent":[]}}],"position":{"start":{"line":110,"column":1,"offset":3603},"end":{"line":110,"column":9,"offset":3611},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"检查是否需要扩容","position":{"start":{"line":111,"column":4,"offset":3615},"end":{"line":111,"column":12,"offset":3623},"indent":[]}}],"position":{"start":{"line":111,"column":4,"offset":3615},"end":{"line":111,"column":12,"offset":3623},"indent":[]}}],"position":{"start":{"line":111,"column":1,"offset":3612},"end":{"line":111,"column":12,"offset":3623},"indent":[]}}],"position":{"start":{"line":106,"column":1,"offset":3496},"end":{"line":111,"column":12,"offset":3623},"indent":[1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"其中还涉及到是否需要把链表结构变成树结构，在元素减少的时候，把树结构变成链表结构。","position":{"start":{"line":113,"column":1,"offset":3625},"end":{"line":113,"column":42,"offset":3666},"indent":[]}}],"position":{"start":{"line":113,"column":1,"offset":3625},"end":{"line":113,"column":42,"offset":3666},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"添加元素的时候，还考虑是否需要扩容，扩容的时候会对重新做 rehash， rehash 就会导致不稳定","position":{"start":{"line":115,"column":1,"offset":3668},"end":{"line":115,"column":52,"offset":3719},"indent":[]}}],"position":{"start":{"line":115,"column":1,"offset":3668},"end":{"line":115,"column":52,"offset":3719},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#linkedhashmap","title":null,"data":{"hProperties":{"aria-hidden":true,"class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"LinkedHashMap","position":{"start":{"line":117,"column":4,"offset":3724},"end":{"line":117,"column":17,"offset":3737},"indent":[]}}],"position":{"start":{"line":117,"column":1,"offset":3721},"end":{"line":117,"column":17,"offset":3737},"indent":[]},"data":{"id":"linkedhashmap","htmlAttributes":{"id":"linkedhashmap"},"hProperties":{"id":"linkedhashmap"}}},{"type":"paragraph","children":[{"type":"text","value":"LinkedHashMap 和 HashMap 的区别主要就是 Linked 这个字，他在内部维护一个双向链表的实现。并由这个双向链表来保持遍历顺序的稳定，通常来说这个顺序由插入时顺序决定。","position":{"start":{"line":119,"column":1,"offset":3739},"end":{"line":119,"column":96,"offset":3834},"indent":[]}}],"position":{"start":{"line":119,"column":1,"offset":3739},"end":{"line":119,"column":96,"offset":3834},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"LinkedHashMap 同样也是线程不安全的。","position":{"start":{"line":121,"column":1,"offset":3836},"end":{"line":121,"column":26,"offset":3861},"indent":[]}}],"position":{"start":{"line":121,"column":1,"offset":3836},"end":{"line":121,"column":26,"offset":3861},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"LinkedHashMap 提供一个特殊的构造函数，遍历顺序根据最后访问时间,  accessOrder = true, 默认情况下 accessOrder = false， 遍历时根据插入顺序","position":{"start":{"line":123,"column":1,"offset":3863},"end":{"line":123,"column":98,"offset":3960},"indent":[]}}],"position":{"start":{"line":123,"column":1,"offset":3863},"end":{"line":123,"column":98,"offset":3960},"indent":[]}},{"type":"html","lang":"java","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">    <span class=\"token comment\">/**\n     * Constructs an empty {@code LinkedHashMap} instance with the\n     * specified initial capacity, load factor and ordering mode.\n     *\n     * @param  initialCapacity the initial capacity\n     * @param  loadFactor      the load factor\n     * @param  accessOrder     the ordering mode - {@code true} for\n     *         access-order, {@code false} for insertion-order\n     * @throws IllegalArgumentException if the initial capacity is negative\n     *         or the load factor is nonpositive\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">LinkedHashMap</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> initialCapacity<span class=\"token punctuation\">,</span>\n                         <span class=\"token keyword\">float</span> loadFactor<span class=\"token punctuation\">,</span>\n                         <span class=\"token keyword\">boolean</span> accessOrder<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>initialCapacity<span class=\"token punctuation\">,</span> loadFactor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>accessOrder <span class=\"token operator\">=</span> accessOrder<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":125,"column":1,"offset":3962},"end":{"line":143,"column":4,"offset":4711},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"这种方式特别时候构建一个 LRU 缓存数据， ","position":{"start":{"line":145,"column":1,"offset":4713},"end":{"line":145,"column":24,"offset":4736},"indent":[]}}],"position":{"start":{"line":145,"column":1,"offset":4713},"end":{"line":145,"column":24,"offset":4736},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#treemap","title":null,"data":{"hProperties":{"aria-hidden":true,"class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"TreeMap","position":{"start":{"line":147,"column":4,"offset":4741},"end":{"line":147,"column":11,"offset":4748},"indent":[]}}],"position":{"start":{"line":147,"column":1,"offset":4738},"end":{"line":147,"column":11,"offset":4748},"indent":[]},"data":{"id":"treemap","htmlAttributes":{"id":"treemap"},"hProperties":{"id":"treemap"}}},{"type":"paragraph","children":[{"type":"text","value":"TreeMap 实现了 NavigableMap， 而 NavigableMap 继承了 SortedMap。 因此 TreeMap 中的元素都是按照他们的 Comparable 实现或者 Comparator 排序的，存储是有序的。因为实际是以 tree 的形式存储的，因此 add，remove 和 contains 都可以保证 log(n) 的时间复杂度。","position":{"start":{"line":149,"column":1,"offset":4750},"end":{"line":149,"column":182,"offset":4931},"indent":[]}}],"position":{"start":{"line":149,"column":1,"offset":4750},"end":{"line":149,"column":182,"offset":4931},"indent":[]}},{"type":"blockquote","children":[{"type":"paragraph","children":[{"type":"text","value":"A Red-Black tree based {@link NavigableMap} implementation.\nThe map is sorted according to the {@linkplain Comparable natural\nordering} of its keys, or by a {@link Comparator} provided at map\ncreation time, depending on which constructor is used.","position":{"start":{"line":151,"column":3,"offset":4935},"end":{"line":154,"column":57,"offset":5187},"indent":[3,3,3]}}],"position":{"start":{"line":151,"column":3,"offset":4935},"end":{"line":154,"column":57,"offset":5187},"indent":[3,3,3]}}],"position":{"start":{"line":151,"column":1,"offset":4933},"end":{"line":154,"column":57,"offset":5187},"indent":[1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#什么时候用哪个-map-结构呢？","title":null,"data":{"hProperties":{"aria-hidden":true,"class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"什么时候用哪个 Map 结构呢？","position":{"start":{"line":158,"column":4,"offset":5194},"end":{"line":158,"column":20,"offset":5210},"indent":[]}}],"position":{"start":{"line":158,"column":1,"offset":5191},"end":{"line":158,"column":20,"offset":5210},"indent":[]},"data":{"id":"什么时候用哪个-map-结构呢？","htmlAttributes":{"id":"什么时候用哪个-map-结构呢？"},"hProperties":{"id":"什么时候用哪个-map-结构呢？"}}},{"type":"paragraph","children":[{"type":"text","value":"根据特性来决定使用哪个结构","position":{"start":{"line":160,"column":1,"offset":5212},"end":{"line":160,"column":14,"offset":5225},"indent":[]}}],"position":{"start":{"line":160,"column":1,"offset":5212},"end":{"line":160,"column":14,"offset":5225},"indent":[]}},{"type":"table","align":[null,"right","right","right"],"children":[{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"特性","position":{"start":{"line":162,"column":6,"offset":5232},"end":{"line":162,"column":8,"offset":5234},"indent":[]}}],"position":{"start":{"line":162,"column":6,"offset":5232},"end":{"line":162,"column":12,"offset":5238},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"HashMap","position":{"start":{"line":162,"column":15,"offset":5241},"end":{"line":162,"column":22,"offset":5248},"indent":[]}}],"position":{"start":{"line":162,"column":15,"offset":5241},"end":{"line":162,"column":26,"offset":5252},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"LinkedHashMap","position":{"start":{"line":162,"column":29,"offset":5255},"end":{"line":162,"column":42,"offset":5268},"indent":[]}}],"position":{"start":{"line":162,"column":29,"offset":5255},"end":{"line":162,"column":42,"offset":5268},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"TreeMap","position":{"start":{"line":162,"column":45,"offset":5271},"end":{"line":162,"column":52,"offset":5278},"indent":[]}}],"position":{"start":{"line":162,"column":45,"offset":5271},"end":{"line":162,"column":54,"offset":5280},"indent":[]}}],"position":{"start":{"line":162,"column":1,"offset":5227},"end":{"line":162,"column":56,"offset":5282},"indent":[]}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"遍历","position":{"start":{"line":164,"column":3,"offset":5343},"end":{"line":164,"column":5,"offset":5345},"indent":[]}}],"position":{"start":{"line":164,"column":3,"offset":5343},"end":{"line":164,"column":5,"offset":5345},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"无序","position":{"start":{"line":164,"column":8,"offset":5348},"end":{"line":164,"column":10,"offset":5350},"indent":[]}}],"position":{"start":{"line":164,"column":8,"offset":5348},"end":{"line":164,"column":10,"offset":5350},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"根据插入顺序或者最后访问时间","position":{"start":{"line":164,"column":13,"offset":5353},"end":{"line":164,"column":27,"offset":5367},"indent":[]}}],"position":{"start":{"line":164,"column":13,"offset":5353},"end":{"line":164,"column":27,"offset":5367},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"根据 Comparable 结果","position":{"start":{"line":164,"column":30,"offset":5370},"end":{"line":164,"column":46,"offset":5386},"indent":[]}}],"position":{"start":{"line":164,"column":30,"offset":5370},"end":{"line":164,"column":46,"offset":5386},"indent":[]}}],"position":{"start":{"line":164,"column":1,"offset":5341},"end":{"line":164,"column":48,"offset":5388},"indent":[]}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"线程安全","position":{"start":{"line":165,"column":3,"offset":5391},"end":{"line":165,"column":7,"offset":5395},"indent":[]}}],"position":{"start":{"line":165,"column":3,"offset":5391},"end":{"line":165,"column":7,"offset":5395},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"否","position":{"start":{"line":165,"column":10,"offset":5398},"end":{"line":165,"column":11,"offset":5399},"indent":[]}}],"position":{"start":{"line":165,"column":10,"offset":5398},"end":{"line":165,"column":11,"offset":5399},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"否","position":{"start":{"line":165,"column":14,"offset":5402},"end":{"line":165,"column":15,"offset":5403},"indent":[]}}],"position":{"start":{"line":165,"column":14,"offset":5402},"end":{"line":165,"column":15,"offset":5403},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"否","position":{"start":{"line":165,"column":18,"offset":5406},"end":{"line":165,"column":19,"offset":5407},"indent":[]}}],"position":{"start":{"line":165,"column":18,"offset":5406},"end":{"line":165,"column":19,"offset":5407},"indent":[]}}],"position":{"start":{"line":165,"column":1,"offset":5389},"end":{"line":165,"column":21,"offset":5409},"indent":[]}}],"position":{"start":{"line":162,"column":1,"offset":5227},"end":{"line":165,"column":21,"offset":5409},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"所以，总的来说，HashMap 符合通用的场景； 如果你需要一个保持插入时顺序的，或者要构建一个 LRU 缓存，用 LinkedHashMap。 如果你想要一个能排序的，比如根据姓名能依次输出结果的Map，那么就使用 TreeMap","position":{"start":{"line":167,"column":1,"offset":5411},"end":{"line":167,"column":117,"offset":5527},"indent":[]}}],"position":{"start":{"line":167,"column":1,"offset":5411},"end":{"line":167,"column":117,"offset":5527},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":172,"column":1,"offset":5532}}}}