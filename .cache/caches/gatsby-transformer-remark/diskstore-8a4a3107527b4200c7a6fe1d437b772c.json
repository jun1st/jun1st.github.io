{"expireTime":9007200864318180000,"key":"transformer-remark-markdown-ast-133190334ba76fa9e7b75f00c5d61ca9-gatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-autolink-headersgatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypantsgatsby-remark-external-links-","val":{"type":"root","children":[{"type":"heading","depth":2,"children":[{"type":"link","url":"#下载-kafka","title":null,"data":{"hProperties":{"aria-hidden":true,"class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"下载 Kafka","position":{"start":{"line":2,"column":4,"offset":4},"end":{"line":2,"column":12,"offset":12},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":12,"offset":12},"indent":[]},"data":{"id":"下载-kafka","htmlAttributes":{"id":"下载-kafka"},"hProperties":{"id":"下载-kafka"}}},{"type":"paragraph","children":[{"type":"text","value":"通过 Kafka 官网下载最新的 Kafka， Kafka 的版本更新还是蛮保守传统的，目前还是 2.4.0 的版本。 但是解压包文件，解压出来的文件夹是 kafka_2.12-2.4.0, 什么 2.12？\n其实这是使用的 Scala 的版本，2.4.0 才是当前的 Kafka 的版本","position":{"start":{"line":4,"column":1,"offset":14},"end":{"line":5,"column":40,"offset":158},"indent":[1]}}],"position":{"start":{"line":4,"column":1,"offset":14},"end":{"line":5,"column":40,"offset":158},"indent":[1]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#集群配置","title":null,"data":{"hProperties":{"aria-hidden":true,"class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"集群配置","position":{"start":{"line":7,"column":4,"offset":163},"end":{"line":7,"column":8,"offset":167},"indent":[]}}],"position":{"start":{"line":7,"column":1,"offset":160},"end":{"line":7,"column":8,"offset":167},"indent":[]},"data":{"id":"集群配置","htmlAttributes":{"id":"集群配置"},"hProperties":{"id":"集群配置"}}},{"type":"paragraph","children":[{"type":"text","value":"Kafka 的关键配置 server.properties","position":{"start":{"line":9,"column":1,"offset":169},"end":{"line":9,"column":30,"offset":198},"indent":[]}}],"position":{"start":{"line":9,"column":1,"offset":169},"end":{"line":9,"column":30,"offset":198},"indent":[]}},{"type":"html","lang":"xml","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\">broker.id=1\nlisteners=PLAINTEXT://:9090\nlog.dirs=/tmp/kafka-logs\nnum.partitions=3\noffsets.topic.replication.factor=3\nzookeeper.connect=localhost:2181</code></pre></div>","position":{"start":{"line":11,"column":1,"offset":200},"end":{"line":18,"column":4,"offset":360},"indent":[1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"设置每个 Topic 的 partitions 数为 3，并且设置 offsets 的 replication factor 为 3。","position":{"start":{"line":20,"column":1,"offset":362},"end":{"line":20,"column":68,"offset":429},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":362},"end":{"line":20,"column":68,"offset":429},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"创建一个 server-1.properties 和 server-2.properties 文件， 因为在本地机器上，部署一个假的 Kafka 集群，所有需要修改的值有 broker.id, listeners, log.dirs,\n不同的 broker，在本机上配置不同的 log 目录。","position":{"start":{"line":22,"column":1,"offset":431},"end":{"line":23,"column":29,"offset":577},"indent":[1]}}],"position":{"start":{"line":22,"column":1,"offset":431},"end":{"line":23,"column":29,"offset":577},"indent":[1]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#开启-kafka-集群","title":null,"data":{"hProperties":{"aria-hidden":true,"class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"开启 Kafka 集群","position":{"start":{"line":25,"column":4,"offset":582},"end":{"line":25,"column":15,"offset":593},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":579},"end":{"line":25,"column":15,"offset":593},"indent":[]},"data":{"id":"开启-kafka-集群","htmlAttributes":{"id":"开启-kafka-集群"},"hProperties":{"id":"开启-kafka-集群"}}},{"type":"paragraph","children":[{"type":"text","value":"先开启 zookeeper, 进入 Kafka 目录，","position":{"start":{"line":27,"column":1,"offset":595},"end":{"line":27,"column":28,"offset":622},"indent":[]}}],"position":{"start":{"line":27,"column":1,"offset":595},"end":{"line":27,"column":28,"offset":622},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">bin/zookeeper-server-start.sh config/zookeeper.properties</code></pre></div>","position":{"start":{"line":29,"column":1,"offset":624},"end":{"line":31,"column":4,"offset":693},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"在依次开启三个 Kafka 实例。","position":{"start":{"line":33,"column":1,"offset":695},"end":{"line":33,"column":18,"offset":712},"indent":[]}}],"position":{"start":{"line":33,"column":1,"offset":695},"end":{"line":33,"column":18,"offset":712},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">bin/kafka-server-start.sh config/server.properties\nbin/kafka-server-start.sh config/server-1.properties\nbin/kafka-server-start.sh config/server-2.properties</code></pre></div>","position":{"start":{"line":35,"column":1,"offset":714},"end":{"line":39,"column":4,"offset":882},"indent":[1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"应该开启成功了三个 Kafka 实例。 在这里没有以 daemon 的模式开启 Kafka，是想能实时的看到运行的 log。 我们来看下 Kafka 中的 Topic 数据。","position":{"start":{"line":41,"column":1,"offset":884},"end":{"line":41,"column":88,"offset":971},"indent":[]}}],"position":{"start":{"line":41,"column":1,"offset":884},"end":{"line":41,"column":88,"offset":971},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">bin/kafka-topics.sh --bootstrap-server localhost:9092 --list\n<span class=\"token comment\">## __consumer_offsets</span></code></pre></div>","position":{"start":{"line":43,"column":1,"offset":973},"end":{"line":46,"column":4,"offset":1067},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"只有一个 topic， ","position":{"start":{"line":48,"column":1,"offset":1069},"end":{"line":48,"column":13,"offset":1081},"indent":[]}},{"type":"text","value":"_","position":{"start":{"line":48,"column":13,"offset":1081},"end":{"line":48,"column":15,"offset":1083},"indent":[]}},{"type":"text","value":"_","position":{"start":{"line":48,"column":15,"offset":1083},"end":{"line":48,"column":17,"offset":1085},"indent":[]}},{"type":"text","value":"consumer_offsets, 这个 topic 是 kafka 默认创建的。 来看下这个 topic 的一些属性，","position":{"start":{"line":48,"column":17,"offset":1085},"end":{"line":48,"column":77,"offset":1145},"indent":[]}}],"position":{"start":{"line":48,"column":1,"offset":1069},"end":{"line":48,"column":77,"offset":1145},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">bin/kafka-topics.sh --bootstrap-server localhost:9092 --describe __consumber_offsets\n<span class=\"token comment\">## Topic: __consumer_offsets\tPartitionCount: 50\tReplicationFactor: 1\tConfigs: compression.type=producer,cleanup.policy=compact,segment.bytes=104857600</span></code></pre></div>","position":{"start":{"line":50,"column":1,"offset":1147},"end":{"line":53,"column":4,"offset":1394},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"可以看到这个 Topic 的 50 个分区数据，但是 replication 数却是 1。 这个 1 意味着前面的分区数据，只会存在于一个 broker 中，如果某一个 broker 坏了，那么存在这个 broker 中的分片数据，\n就不可用。","position":{"start":{"line":55,"column":1,"offset":1396},"end":{"line":56,"column":6,"offset":1518},"indent":[1]}}],"position":{"start":{"line":55,"column":1,"offset":1396},"end":{"line":56,"column":6,"offset":1518},"indent":[1]}},{"type":"heading","depth":3,"children":[{"type":"link","url":"#修改-consumer_offsets-replication-数","title":null,"data":{"hProperties":{"aria-hidden":true,"class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"修改 consumer_offsets Replication 数","position":{"start":{"line":58,"column":5,"offset":1524},"end":{"line":58,"column":38,"offset":1557},"indent":[]}}],"position":{"start":{"line":58,"column":1,"offset":1520},"end":{"line":58,"column":38,"offset":1557},"indent":[]},"data":{"id":"修改-consumer_offsets-replication-数","htmlAttributes":{"id":"修改-consumer_offsets-replication-数"},"hProperties":{"id":"修改-consumer_offsets-replication-数"}}},{"type":"paragraph","children":[{"type":"text","value":"修改 consumer_offsets 的 replication factor，需要用到 kafka 的 reassignment 功能， 这时需要自己提供一个 assignment json 文件。","position":{"start":{"line":60,"column":1,"offset":1559},"end":{"line":60,"column":102,"offset":1660},"indent":[]}}],"position":{"start":{"line":60,"column":1,"offset":1559},"end":{"line":60,"column":102,"offset":1660},"indent":[]}},{"type":"html","lang":"jsxon","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"jsxon\"><pre class=\"language-jsxon\"><code class=\"language-jsxon\">{\n  &quot;version&quot;: 1,\n  &quot;partitions&quot;: [\n    { &quot;topic&quot;: &quot;__consumer_offsets&quot;, &quot;partition&quot;: 0, &quot;replicas&quot;: [1, 2, 3] },\n    { &quot;topic&quot;: &quot;__consumer_offsets&quot;, &quot;partition&quot;: 1, &quot;replicas&quot;: [1, 2, 3] },\n    { &quot;topic&quot;: &quot;__consumer_offsets&quot;, &quot;partition&quot;: 2, &quot;replicas&quot;: [1, 2, 3] },\n    ...\n  ]\n}</code></pre></div>","position":{"start":{"line":62,"column":1,"offset":1662},"end":{"line":72,"column":4,"offset":1958},"indent":[1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"完整的 json 文件可以在这里下载： ","position":{"start":{"line":74,"column":1,"offset":1960},"end":{"line":74,"column":21,"offset":1980},"indent":[]}},{"type":"link","title":null,"url":"https://gist.github.com/jun1st/31aaf1ebe6c93c4a11079073512a9c30","children":[{"type":"text","value":"gist","position":{"start":{"line":74,"column":22,"offset":1981},"end":{"line":74,"column":26,"offset":1985},"indent":[]}}],"position":{"start":{"line":74,"column":21,"offset":1980},"end":{"line":74,"column":92,"offset":2051},"indent":[]},"data":{"hProperties":{"target":"_blank","rel":"nofollow noopener noreferrer"}}}],"position":{"start":{"line":74,"column":1,"offset":1960},"end":{"line":74,"column":92,"offset":2051},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"执行修改：","position":{"start":{"line":76,"column":1,"offset":2053},"end":{"line":76,"column":6,"offset":2058},"indent":[]}}],"position":{"start":{"line":76,"column":1,"offset":2053},"end":{"line":76,"column":6,"offset":2058},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">bin/kafka-reassign-partitions.sh --zookeeper localhost:2181 --reassignment-json-file __consumer_offsets.json --execute</code></pre></div>","position":{"start":{"line":78,"column":1,"offset":2060},"end":{"line":80,"column":4,"offset":2190},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"执行完毕，再用 describe 查看 topic 信息","position":{"start":{"line":82,"column":1,"offset":2192},"end":{"line":82,"column":29,"offset":2220},"indent":[]}}],"position":{"start":{"line":82,"column":1,"offset":2192},"end":{"line":82,"column":29,"offset":2220},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">bin/kafka-topics.sh --bootstrap-server localhost:9092 --describe __consumber_offsets\n<span class=\"token comment\"># Topic: __consumer_offsets\tPartitionCount: 50\tReplicationFactor: 3\tConfigs: compression.type=producer,cleanup.policy=compact,segment.bytes=104857600</span></code></pre></div>","position":{"start":{"line":84,"column":1,"offset":2222},"end":{"line":87,"column":4,"offset":2468},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"执行成功，","position":{"start":{"line":89,"column":1,"offset":2470},"end":{"line":89,"column":6,"offset":2475},"indent":[]}}],"position":{"start":{"line":89,"column":1,"offset":2470},"end":{"line":89,"column":6,"offset":2475},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"这时，你关掉一个 kafka 实例，停掉一个 broker，并不会看到有报错信息，而是会看到 kafka 的 rebalance log，","position":{"start":{"line":91,"column":1,"offset":2477},"end":{"line":91,"column":70,"offset":2546},"indent":[]}}],"position":{"start":{"line":91,"column":1,"offset":2477},"end":{"line":91,"column":70,"offset":2546},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token punctuation\">[</span><span class=\"token number\">2019</span>-12-29 <span class=\"token number\">21</span>:53:09,341<span class=\"token punctuation\">]</span> INFO <span class=\"token punctuation\">[</span>GroupMetadataManager <span class=\"token assign-left variable\">brokerId</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> Finished loading offsets and group metadata from __consumer_offsets-23 <span class=\"token keyword\">in</span> <span class=\"token number\">0</span> milliseconds. <span class=\"token punctuation\">(</span>kafka.coordinator.group.GroupMetadataManager<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">2019</span>-12-29 <span class=\"token number\">21</span>:53:09,341<span class=\"token punctuation\">]</span> INFO <span class=\"token punctuation\">[</span>GroupMetadataManager <span class=\"token assign-left variable\">brokerId</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> Finished loading offsets and group metadata from __consumer_offsets-26 <span class=\"token keyword\">in</span> <span class=\"token number\">0</span> milliseconds. <span class=\"token punctuation\">(</span>kafka.coordinator.group.GroupMetadataManager<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">2019</span>-12-29 <span class=\"token number\">21</span>:53:09,341<span class=\"token punctuation\">]</span> INFO <span class=\"token punctuation\">[</span>GroupMetadataManager <span class=\"token assign-left variable\">brokerId</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> Finished loading offsets and group metadata from __consumer_offsets-29 <span class=\"token keyword\">in</span> <span class=\"token number\">0</span> milliseconds. <span class=\"token punctuation\">(</span>kafka.coordinator.group.GroupMetadataManager<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">2019</span>-12-29 <span class=\"token number\">21</span>:53:09,341<span class=\"token punctuation\">]</span> INFO <span class=\"token punctuation\">[</span>GroupMetadataManager <span class=\"token assign-left variable\">brokerId</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> Finished loading offsets and group metadata from __consumer_offsets-32 <span class=\"token keyword\">in</span> <span class=\"token number\">0</span> milliseconds. <span class=\"token punctuation\">(</span>kafka.coordinator.group.GroupMetadataManager<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">2019</span>-12-29 <span class=\"token number\">21</span>:53:09,341<span class=\"token punctuation\">]</span> INFO <span class=\"token punctuation\">[</span>GroupMetadataManager <span class=\"token assign-left variable\">brokerId</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> Finished loading offsets and group metadata from __consumer_offsets-35 <span class=\"token keyword\">in</span> <span class=\"token number\">0</span> milliseconds. <span class=\"token punctuation\">(</span>kafka.coordinator.group.GroupMetadataManager<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">2019</span>-12-29 <span class=\"token number\">21</span>:53:09,341<span class=\"token punctuation\">]</span> INFO <span class=\"token punctuation\">[</span>GroupMetadataManager <span class=\"token assign-left variable\">brokerId</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> Finished loading offsets and group metadata from __consumer_offsets-38 <span class=\"token keyword\">in</span> <span class=\"token number\">0</span> milliseconds. <span class=\"token punctuation\">(</span>kafka.coordinator.group.GroupMetadataManager<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">2019</span>-12-29 <span class=\"token number\">21</span>:53:09,342<span class=\"token punctuation\">]</span> INFO <span class=\"token punctuation\">[</span>GroupMetadataManager <span class=\"token assign-left variable\">brokerId</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> Finished loading offsets and group metadata from __consumer_offsets-41 <span class=\"token keyword\">in</span> <span class=\"token number\">1</span> milliseconds. <span class=\"token punctuation\">(</span>kafka.coordinator.group.GroupMetadataManager<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">2019</span>-12-29 <span class=\"token number\">21</span>:53:09,342<span class=\"token punctuation\">]</span> INFO <span class=\"token punctuation\">[</span>GroupMetadataManager <span class=\"token assign-left variable\">brokerId</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> Finished loading offsets and group metadata from __consumer_offsets-44 <span class=\"token keyword\">in</span> <span class=\"token number\">0</span> milliseconds. <span class=\"token punctuation\">(</span>kafka.coordinator.group.GroupMetadataManager<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">2019</span>-12-29 <span class=\"token number\">21</span>:53:09,342<span class=\"token punctuation\">]</span> INFO <span class=\"token punctuation\">[</span>GroupMetadataManager <span class=\"token assign-left variable\">brokerId</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> Finished loading offsets and group metadata from __consumer_offsets-47 <span class=\"token keyword\">in</span> <span class=\"token number\">0</span> milliseconds. <span class=\"token punctuation\">(</span>kafka.coordinator.group.GroupMetadataManager<span class=\"token punctuation\">)</span></code></pre></div>","position":{"start":{"line":93,"column":1,"offset":2548},"end":{"line":103,"column":4,"offset":4377},"indent":[1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"再把关掉的 kafka 实例开起来，会看到新的 broker 加入 cluster 的 log","position":{"start":{"line":105,"column":1,"offset":4379},"end":{"line":105,"column":48,"offset":4426},"indent":[]}}],"position":{"start":{"line":105,"column":1,"offset":4379},"end":{"line":105,"column":48,"offset":4426},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token punctuation\">[</span><span class=\"token number\">2019</span>-12-29 <span class=\"token number\">21</span>:55:28,427<span class=\"token punctuation\">]</span> INFO <span class=\"token punctuation\">[</span>Partition __consumer_offsets-26 <span class=\"token assign-left variable\">broker</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> ISR updated to <span class=\"token punctuation\">[</span><span class=\"token number\">2,1</span>,3<span class=\"token punctuation\">]</span> and zkVersion updated to <span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">(</span>kafka.cluster.Partition<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">2019</span>-12-29 <span class=\"token number\">21</span>:55:28,427<span class=\"token punctuation\">]</span> INFO <span class=\"token punctuation\">[</span>Partition __consumer_offsets-29 <span class=\"token assign-left variable\">broker</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> Expanding ISR from <span class=\"token number\">2,1</span> to <span class=\"token number\">2,1</span>,3 <span class=\"token punctuation\">(</span>kafka.cluster.Partition<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">2019</span>-12-29 <span class=\"token number\">21</span>:55:28,428<span class=\"token punctuation\">]</span> INFO <span class=\"token punctuation\">[</span>Partition __consumer_offsets-29 <span class=\"token assign-left variable\">broker</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> ISR updated to <span class=\"token punctuation\">[</span><span class=\"token number\">2,1</span>,3<span class=\"token punctuation\">]</span> and zkVersion updated to <span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">(</span>kafka.cluster.Partition<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">2019</span>-12-29 <span class=\"token number\">21</span>:55:28,428<span class=\"token punctuation\">]</span> INFO <span class=\"token punctuation\">[</span>Partition __consumer_offsets-34 <span class=\"token assign-left variable\">broker</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> Expanding ISR from <span class=\"token number\">1,2</span> to <span class=\"token number\">1,2</span>,3 <span class=\"token punctuation\">(</span>kafka.cluster.Partition<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">2019</span>-12-29 <span class=\"token number\">21</span>:55:28,428<span class=\"token punctuation\">]</span> INFO <span class=\"token punctuation\">[</span>Partition __consumer_offsets-34 <span class=\"token assign-left variable\">broker</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> ISR updated to <span class=\"token punctuation\">[</span><span class=\"token number\">1,2</span>,3<span class=\"token punctuation\">]</span> and zkVersion updated to <span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">(</span>kafka.cluster.Partition<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">2019</span>-12-29 <span class=\"token number\">21</span>:55:28,428<span class=\"token punctuation\">]</span> INFO <span class=\"token punctuation\">[</span>Partition __consumer_offsets-10 <span class=\"token assign-left variable\">broker</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> Expanding ISR from <span class=\"token number\">1,2</span> to <span class=\"token number\">1,2</span>,3 <span class=\"token punctuation\">(</span>kafka.cluster.Partition<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">2019</span>-12-29 <span class=\"token number\">21</span>:55:28,429<span class=\"token punctuation\">]</span> INFO <span class=\"token punctuation\">[</span>Partition __consumer_offsets-10 <span class=\"token assign-left variable\">broker</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> ISR updated to <span class=\"token punctuation\">[</span><span class=\"token number\">1,2</span>,3<span class=\"token punctuation\">]</span> and zkVersion updated to <span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">(</span>kafka.cluster.Partition<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">2019</span>-12-29 <span class=\"token number\">21</span>:55:28,429<span class=\"token punctuation\">]</span> INFO <span class=\"token punctuation\">[</span>Partition __consumer_offsets-32 <span class=\"token assign-left variable\">broker</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> Expanding ISR from <span class=\"token number\">2,1</span> to <span class=\"token number\">2,1</span>,3 <span class=\"token punctuation\">(</span>kafka.cluster.Partition<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">2019</span>-12-29 <span class=\"token number\">21</span>:55:28,430<span class=\"token punctuation\">]</span> INFO <span class=\"token punctuation\">[</span>Partition __consumer_offsets-32 <span class=\"token assign-left variable\">broker</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> ISR updated to <span class=\"token punctuation\">[</span><span class=\"token number\">2,1</span>,3<span class=\"token punctuation\">]</span> and zkVersion updated to <span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">(</span>kafka.cluster.Partition<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">2019</span>-12-29 <span class=\"token number\">21</span>:55:28,430<span class=\"token punctuation\">]</span> INFO <span class=\"token punctuation\">[</span>Partition __consumer_offsets-40 <span class=\"token assign-left variable\">broker</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> Expanding ISR from <span class=\"token number\">1,2</span> to <span class=\"token number\">1,2</span>,3 <span class=\"token punctuation\">(</span>kafka.cluster.Partition<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">2019</span>-12-29 <span class=\"token number\">21</span>:55:28,430<span class=\"token punctuation\">]</span> INFO <span class=\"token punctuation\">[</span>Partition __consumer_offsets-40 <span class=\"token assign-left variable\">broker</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> ISR updated to <span class=\"token punctuation\">[</span><span class=\"token number\">1,2</span>,3<span class=\"token punctuation\">]</span> and zkVersion updated to <span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">(</span>kafka.cluster.Partition<span class=\"token punctuation\">)</span></code></pre></div>","position":{"start":{"line":107,"column":1,"offset":4428},"end":{"line":119,"column":4,"offset":6014},"indent":[1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#使用-kafka-manager-来管理","title":null,"data":{"hProperties":{"aria-hidden":true,"class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"使用 Kafka Manager 来管理","position":{"start":{"line":121,"column":4,"offset":6019},"end":{"line":121,"column":24,"offset":6039},"indent":[]}}],"position":{"start":{"line":121,"column":1,"offset":6016},"end":{"line":121,"column":24,"offset":6039},"indent":[]},"data":{"id":"使用-kafka-manager-来管理","htmlAttributes":{"id":"使用-kafka-manager-来管理"},"hProperties":{"id":"使用-kafka-manager-来管理"}}},{"type":"paragraph","children":[{"type":"text","value":"Kafka Manager 是 Yahoo 开源的 Kafka 管理工具，在 github 上","position":{"start":{"line":123,"column":1,"offset":6041},"end":{"line":123,"column":48,"offset":6088},"indent":[]}},{"type":"link","title":null,"url":"https://github.com/yahoo/kafka-manager","children":[{"type":"text","value":"下载","position":{"start":{"line":123,"column":49,"offset":6089},"end":{"line":123,"column":51,"offset":6091},"indent":[]}}],"position":{"start":{"line":123,"column":48,"offset":6088},"end":{"line":123,"column":92,"offset":6132},"indent":[]},"data":{"hProperties":{"target":"_blank","rel":"nofollow noopener noreferrer"}}}],"position":{"start":{"line":123,"column":1,"offset":6041},"end":{"line":123,"column":92,"offset":6132},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"在本机上，按照说明下载就好，","position":{"start":{"line":125,"column":1,"offset":6134},"end":{"line":125,"column":15,"offset":6148},"indent":[]}}],"position":{"start":{"line":125,"column":1,"offset":6134},"end":{"line":125,"column":15,"offset":6148},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"管理界面如下：","position":{"start":{"line":127,"column":1,"offset":6150},"end":{"line":127,"column":8,"offset":6157},"indent":[]}}],"position":{"start":{"line":127,"column":1,"offset":6150},"end":{"line":127,"column":8,"offset":6157},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"/posts/kafka-manager.png","alt":"kafka-manager","position":{"start":{"line":129,"column":1,"offset":6159},"end":{"line":129,"column":43,"offset":6201},"indent":[]}}],"position":{"start":{"line":129,"column":1,"offset":6159},"end":{"line":129,"column":43,"offset":6201},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Replicas 数是 3 !!!","position":{"start":{"line":131,"column":1,"offset":6203},"end":{"line":131,"column":18,"offset":6220},"indent":[]}}],"position":{"start":{"line":131,"column":1,"offset":6203},"end":{"line":131,"column":18,"offset":6220},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":131,"column":18,"offset":6220}}}}