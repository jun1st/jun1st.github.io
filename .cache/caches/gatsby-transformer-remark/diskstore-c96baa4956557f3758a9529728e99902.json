{"expireTime":9007200844525506000,"key":"transformer-remark-markdown-ast-9035cd1585db7e2ab9493cc69431f5f5-gatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-autolink-headersgatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypantsgatsby-remark-external-links-","val":{"type":"root","children":[{"type":"heading","depth":2,"children":[{"type":"link","url":"#关键-kafka-参数","title":null,"data":{"hProperties":{"aria-hidden":true,"class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"关键 Kafka 参数","position":{"start":{"line":2,"column":4,"offset":4},"end":{"line":2,"column":15,"offset":15},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":15,"offset":15},"indent":[]},"data":{"id":"关键-kafka-参数","htmlAttributes":{"id":"关键-kafka-参数"},"hProperties":{"id":"关键-kafka-参数"}}},{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">broker.id</code>","position":{"start":{"line":4,"column":1,"offset":17},"end":{"line":4,"column":12,"offset":28},"indent":[]}},{"type":"text","value":": 每个 Kafka Broker 都需要有一个唯一的 Id","position":{"start":{"line":4,"column":12,"offset":28},"end":{"line":4,"column":42,"offset":58},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":17},"end":{"line":4,"column":42,"offset":58},"indent":[]}},{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">port</code>","position":{"start":{"line":6,"column":1,"offset":60},"end":{"line":6,"column":7,"offset":66},"indent":[]}},{"type":"text","value":": 这是 Kafka 监听的端口，也就是客户端使用的端口","position":{"start":{"line":6,"column":7,"offset":66},"end":{"line":6,"column":35,"offset":94},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":60},"end":{"line":6,"column":35,"offset":94},"indent":[]}},{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">zookeeper.connect</code>","position":{"start":{"line":8,"column":1,"offset":96},"end":{"line":8,"column":20,"offset":115},"indent":[]}},{"type":"text","value":": 这是 zookeeper 的地址，","position":{"start":{"line":8,"column":20,"offset":115},"end":{"line":8,"column":39,"offset":134},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":96},"end":{"line":8,"column":39,"offset":134},"indent":[]}},{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">log.dirs</code>","position":{"start":{"line":10,"column":1,"offset":136},"end":{"line":10,"column":11,"offset":146},"indent":[]}},{"type":"text","value":": 这个是 Kafka 存储数据的地方","position":{"start":{"line":10,"column":11,"offset":146},"end":{"line":10,"column":30,"offset":165},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":136},"end":{"line":10,"column":30,"offset":165},"indent":[]}},{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">auto.create.topics.enable</code>","position":{"start":{"line":12,"column":1,"offset":167},"end":{"line":12,"column":28,"offset":194},"indent":[]}},{"type":"text","value":": 是否允许自动创建 topic","position":{"start":{"line":12,"column":28,"offset":194},"end":{"line":12,"column":44,"offset":210},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":167},"end":{"line":12,"column":44,"offset":210},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"link","url":"#关键-topic-参数","title":null,"data":{"hProperties":{"aria-hidden":true,"class":"anchor"},"hChildren":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]}},{"type":"text","value":"关键 Topic 参数","position":{"start":{"line":14,"column":4,"offset":215},"end":{"line":14,"column":15,"offset":226},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":212},"end":{"line":14,"column":15,"offset":226},"indent":[]},"data":{"id":"关键-topic-参数","htmlAttributes":{"id":"关键-topic-参数"},"hProperties":{"id":"关键-topic-参数"}}},{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">num.partitions</code>","position":{"start":{"line":16,"column":1,"offset":228},"end":{"line":16,"column":17,"offset":244},"indent":[]}},{"type":"text","value":": 一个 topic 有几个 partitions。 默认参数是 1。 Partition 的数量，决定了这个 topic 的性能，当然这个不是越多越好，跟整个集群的 broker 的数量和这个 topic 的吞吐量有关","position":{"start":{"line":16,"column":17,"offset":244},"end":{"line":16,"column":127,"offset":354},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":228},"end":{"line":16,"column":127,"offset":354},"indent":[]}},{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">log.retention.ms</code>","position":{"start":{"line":18,"column":1,"offset":356},"end":{"line":18,"column":19,"offset":374},"indent":[]}},{"type":"text","value":": 这个参数决定了被写到硬盘种的消息数据会被保存多久。 同样的参数还有 ","position":{"start":{"line":18,"column":19,"offset":374},"end":{"line":18,"column":55,"offset":410},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">log.retention.minutes</code>","position":{"start":{"line":18,"column":55,"offset":410},"end":{"line":18,"column":78,"offset":433},"indent":[]}},{"type":"text","value":" 和 ","position":{"start":{"line":18,"column":78,"offset":433},"end":{"line":18,"column":81,"offset":436},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">log.renention.hours</code>","position":{"start":{"line":18,"column":81,"offset":436},"end":{"line":18,"column":103,"offset":458},"indent":[]}},{"type":"text","value":"。 单位小的优先级高， 就是说 ","position":{"start":{"line":18,"column":103,"offset":458},"end":{"line":18,"column":119,"offset":474},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">log.retention.ms</code>","position":{"start":{"line":18,"column":119,"offset":474},"end":{"line":18,"column":137,"offset":492},"indent":[]}},{"type":"text","value":" > ","position":{"start":{"line":18,"column":137,"offset":492},"end":{"line":18,"column":140,"offset":495},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">log.retention.minutes</code>","position":{"start":{"line":18,"column":140,"offset":495},"end":{"line":18,"column":163,"offset":518},"indent":[]}},{"type":"text","value":" > ","position":{"start":{"line":18,"column":163,"offset":518},"end":{"line":18,"column":166,"offset":521},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">log.retention.hours</code>","position":{"start":{"line":18,"column":166,"offset":521},"end":{"line":18,"column":187,"offset":542},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":356},"end":{"line":18,"column":187,"offset":542},"indent":[]}},{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">log.retention.bytes</code>","position":{"start":{"line":20,"column":1,"offset":544},"end":{"line":20,"column":22,"offset":565},"indent":[]}},{"type":"text","value":": 这个参数和上面的参数功能类似，决定了写到磁盘的历史消息保留多久。 需要注意的是本参数的对象是 partition， 如果 ","position":{"start":{"line":20,"column":22,"offset":565},"end":{"line":20,"column":85,"offset":628},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">log.retention.bytes</code>","position":{"start":{"line":20,"column":85,"offset":628},"end":{"line":20,"column":106,"offset":649},"indent":[]}},{"type":"text","value":" 设置为 1GB， 这个 topic 有8个 partition，那么这个 topic 最多可能存储 8 个 GB 的数据。","position":{"start":{"line":20,"column":106,"offset":649},"end":{"line":20,"column":168,"offset":711},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":544},"end":{"line":20,"column":168,"offset":711},"indent":[]}},{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">log.segment.bytes</code>","position":{"start":{"line":23,"column":1,"offset":714},"end":{"line":23,"column":20,"offset":733},"indent":[]}},{"type":"text","value":": 当一个消息被写到磁盘上时，消息会被追加到当前的 log 文件上，这个文件叫做一个 log segment。 当一个 log segment 达到设置的容量上限时，默认为 1 GB。 当前的 log 文件就会被关闭，一个新的 log 文件会被创建。只有当一个 log 文件被认为是关闭时，前面设置的 retention 才会起作用，才可能会被认为过期。 因此这个 segment bytes 非常重要。 比如一个 topic 一天收到 100 MB 的消息数据。那么 10 天会填满一个 segment， 10 天之后这个 segment 会关闭。关闭7天之后，这个 segment 可以被 retired， 因此总的存在时间会是 17 天。","position":{"start":{"line":23,"column":20,"offset":733},"end":{"line":23,"column":342,"offset":1055},"indent":[]}}],"position":{"start":{"line":23,"column":1,"offset":714},"end":{"line":23,"column":342,"offset":1055},"indent":[]}},{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">log.segment.ms</code>","position":{"start":{"line":25,"column":1,"offset":1057},"end":{"line":25,"column":17,"offset":1073},"indent":[]}},{"type":"text","value":": 这个设置确定了一个 segment，多久时间之后可以背关闭。 这个和上面的 bytes 两者是或者的关系，只要其中一个条件满足，这个 log segment 就可以被关闭，等待 retired","position":{"start":{"line":25,"column":17,"offset":1073},"end":{"line":25,"column":115,"offset":1171},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":1057},"end":{"line":25,"column":115,"offset":1171},"indent":[]}},{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">message.max.bytes</code>","position":{"start":{"line":27,"column":1,"offset":1173},"end":{"line":27,"column":20,"offset":1192},"indent":[]}},{"type":"text","value":": 这个是每条消息最大的允许的字节数，超过这个字节 kafka 会报异常给客户端。默认的大小是 1 MB。","position":{"start":{"line":27,"column":20,"offset":1192},"end":{"line":27,"column":73,"offset":1245},"indent":[]}}],"position":{"start":{"line":27,"column":1,"offset":1173},"end":{"line":27,"column":73,"offset":1245},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":27,"column":73,"offset":1245}}}}