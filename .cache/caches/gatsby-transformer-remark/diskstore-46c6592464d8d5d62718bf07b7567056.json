{"expireTime":9007200836088015000,"key":"transformer-remark-markdown-html-ast-03f58012bbf686c3890a93f4f9f20666-gatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-autolink-headersgatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypantsgatsby-remark-external-links-","val":{"type":"root","children":[{"type":"element","tagName":"h2","properties":{"id":"什么是-clickhouse？"},"children":[{"type":"element","tagName":"a","properties":{"href":"#%E4%BB%80%E4%B9%88%E6%98%AF-clickhouse%EF%BC%9F","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"什么是 ClickHouse？","position":{"start":{"line":3,"column":4,"offset":5},"end":{"line":3,"column":19,"offset":20}}}],"position":{"start":{"line":3,"column":1,"offset":2},"end":{"line":3,"column":19,"offset":20}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ClickHouse 是一个用于联机分析(OLAP)的列式数据库管理系统(DBMS)。","position":{"start":{"line":5,"column":1,"offset":22},"end":{"line":5,"column":44,"offset":65}}}],"position":{"start":{"line":5,"column":1,"offset":22},"end":{"line":5,"column":44,"offset":65}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"在传统的行式数据库系统中,处于同一行中的数据总是被物理的存储在一起。在列式数据库中，数据库总是将同一列的数据存储在一起，不同列的数据也总是分开存储。","position":{"start":{"line":7,"column":1,"offset":67},"end":{"line":7,"column":75,"offset":141}}}],"position":{"start":{"line":7,"column":1,"offset":67},"end":{"line":7,"column":75,"offset":141}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"不同的存储方式适合不同的场景，这里的查询场景包括： 进行了哪些查询，多久查询一次以及各类查询的比例； 每种查询读取多少数据————行、列和字节；读取数据和写入数据之间的关系；使用的数据集大小以及如何使用本地的数据集；是否使用事务,以及它们是如何进行隔离的；数据的复制机制与数据的完整性要求；每种类型的查询要求的延迟与吞吐量等等。","position":{"start":{"line":9,"column":1,"offset":143},"end":{"line":9,"column":165,"offset":307}}}],"position":{"start":{"line":9,"column":1,"offset":143},"end":{"line":9,"column":165,"offset":307}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"系统负载越高，根据使用场景进行定制化就越重要，并且定制将会变的越精细。没有一个系统同样适用于明显不同的场景。如果系统适用于广泛的场景，在负载高的情况下，所有的场景可以会被公平但低效处理，或者高效处理一小部分场景。","position":{"start":{"line":11,"column":1,"offset":309},"end":{"line":11,"column":107,"offset":415}}}],"position":{"start":{"line":11,"column":1,"offset":309},"end":{"line":11,"column":107,"offset":415}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"olap-场景的关键特征"},"children":[{"type":"element","tagName":"a","properties":{"href":"#olap-%E5%9C%BA%E6%99%AF%E7%9A%84%E5%85%B3%E9%94%AE%E7%89%B9%E5%BE%81","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"OLAP 场景的关键特征","position":{"start":{"line":13,"column":5,"offset":421},"end":{"line":13,"column":17,"offset":433}}}],"position":{"start":{"line":13,"column":1,"offset":417},"end":{"line":13,"column":17,"offset":433}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"大多数是读请求","position":{"start":{"line":15,"column":3,"offset":437},"end":{"line":15,"column":10,"offset":444}}}],"position":{"start":{"line":15,"column":1,"offset":435},"end":{"line":15,"column":10,"offset":444}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"数据总是以相当大的批(> 1000 rows)进行写入","position":{"start":{"line":16,"column":3,"offset":447},"end":{"line":16,"column":30,"offset":474}}}],"position":{"start":{"line":16,"column":1,"offset":445},"end":{"line":16,"column":30,"offset":474}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"不修改已添加的数据","position":{"start":{"line":17,"column":3,"offset":477},"end":{"line":17,"column":12,"offset":486}}}],"position":{"start":{"line":17,"column":1,"offset":475},"end":{"line":17,"column":12,"offset":486}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"每次查询都从数据库中读取大量的行，但是同时又仅需要少量的列","position":{"start":{"line":18,"column":3,"offset":489},"end":{"line":18,"column":32,"offset":518}}}],"position":{"start":{"line":18,"column":1,"offset":487},"end":{"line":18,"column":32,"offset":518}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"宽表，即每个表包含着大量的列","position":{"start":{"line":19,"column":3,"offset":521},"end":{"line":19,"column":17,"offset":535}}}],"position":{"start":{"line":19,"column":1,"offset":519},"end":{"line":19,"column":17,"offset":535}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"较少的查询(通常每台服务器每秒数百个查询或更少)","position":{"start":{"line":20,"column":3,"offset":538},"end":{"line":20,"column":27,"offset":562}}}],"position":{"start":{"line":20,"column":1,"offset":536},"end":{"line":20,"column":27,"offset":562}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"对于简单查询，允许延迟大约 50 毫秒","position":{"start":{"line":21,"column":3,"offset":565},"end":{"line":21,"column":22,"offset":584}}}],"position":{"start":{"line":21,"column":1,"offset":563},"end":{"line":21,"column":22,"offset":584}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"列中的数据相对较小： 数字和短字符串(例如，每个 URL 60 个字节)","position":{"start":{"line":22,"column":3,"offset":587},"end":{"line":22,"column":39,"offset":623}}}],"position":{"start":{"line":22,"column":1,"offset":585},"end":{"line":22,"column":39,"offset":623}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"处理单个查询时需要高吞吐量（每个服务器每秒高达数十亿行）","position":{"start":{"line":23,"column":3,"offset":626},"end":{"line":23,"column":31,"offset":654}}}],"position":{"start":{"line":23,"column":1,"offset":624},"end":{"line":23,"column":31,"offset":654}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"事务不是必须的","position":{"start":{"line":24,"column":3,"offset":657},"end":{"line":24,"column":10,"offset":664}}}],"position":{"start":{"line":24,"column":1,"offset":655},"end":{"line":24,"column":10,"offset":664}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"对数据一致性要求低","position":{"start":{"line":25,"column":3,"offset":667},"end":{"line":25,"column":12,"offset":676}}}],"position":{"start":{"line":25,"column":1,"offset":665},"end":{"line":25,"column":12,"offset":676}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"每一个查询除了一个大表外都很小","position":{"start":{"line":26,"column":3,"offset":679},"end":{"line":26,"column":18,"offset":694}}}],"position":{"start":{"line":26,"column":1,"offset":677},"end":{"line":26,"column":18,"offset":694}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"查询结果明显小于源数据，换句话说，数据被过滤或聚合后能够被盛放在单台服务器的内存中","position":{"start":{"line":27,"column":3,"offset":697},"end":{"line":27,"column":44,"offset":738}}}],"position":{"start":{"line":27,"column":1,"offset":695},"end":{"line":27,"column":44,"offset":738}}},{"type":"text","value":"\n"}],"position":{"start":{"line":15,"column":1,"offset":435},"end":{"line":27,"column":44,"offset":738}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"很容易可以看出，OLAP 场景与其他流行场景(例如,OLTP 或 K/V)有很大的不同， 因此想要使用 OLTP 或 Key-Value 数据库去高效的处理分析查询是没有意义的，例如，使用 OLAP 数据库去处理分析请求通常要优于使用 MongoDB 或 Redis 去处理分析请求。","position":{"start":{"line":29,"column":1,"offset":740},"end":{"line":29,"column":143,"offset":882}}}],"position":{"start":{"line":29,"column":1,"offset":740},"end":{"line":29,"column":143,"offset":882}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"第一次安装测试-clickhouse"},"children":[{"type":"element","tagName":"a","properties":{"href":"#%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%AE%89%E8%A3%85%E6%B5%8B%E8%AF%95-clickhouse","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"第一次安装测试 clickhouse","position":{"start":{"line":31,"column":4,"offset":887},"end":{"line":31,"column":22,"offset":905}}}],"position":{"start":{"line":31,"column":1,"offset":884},"end":{"line":31,"column":22,"offset":905}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"首次安装测试，用 docker 来得最方便了，yandex 提供了官方的 docker 镜像","position":{"start":{"line":33,"column":1,"offset":907},"end":{"line":33,"column":47,"offset":953}}}],"position":{"start":{"line":33,"column":1,"offset":907},"end":{"line":33,"column":47,"offset":953}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">mkdir</span> <span class=\"token environment constant\">$HOME</span>/some_clickhouse_database\ndocker run -d --name some-clickhouse-server --ulimit <span class=\"token assign-left variable\">nofile</span><span class=\"token operator\">=</span><span class=\"token number\">262144</span>:262144 --volume<span class=\"token operator\">=</span><span class=\"token environment constant\">$HOME</span>/some_clickhouse_database:/var/lib/clickhouse yandex/clickhouse-server</code></pre></div>","position":{"start":{"line":35,"column":1,"offset":955},"end":{"line":38,"column":4,"offset":1162}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"这里指定了本地的一个目录，加载到 docker 容器环境里来存储数据。因为 clickhouse 用到的测试数据一般都比较多，倒入测试数据是一项比较重的工作，因此最好保存在本地，而不依赖于容器环境。","position":{"start":{"line":40,"column":1,"offset":1164},"end":{"line":40,"column":100,"offset":1263}}}],"position":{"start":{"line":40,"column":1,"offset":1164},"end":{"line":40,"column":100,"offset":1263}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"容器启动之后，怎么访问呢？ 最简单的就是进入这个容器的环境，运行 clickhouse-client","position":{"start":{"line":42,"column":1,"offset":1265},"end":{"line":42,"column":51,"offset":1315}}}],"position":{"start":{"line":42,"column":1,"offset":1265},"end":{"line":42,"column":51,"offset":1315}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker <span class=\"token builtin class-name\">exec</span> -it some-clickhouse-server <span class=\"token function\">bash</span></code></pre></div>","position":{"start":{"line":44,"column":1,"offset":1317},"end":{"line":46,"column":4,"offset":1372}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"进入容器之后，来到 /etc/clickhouse-server/ 目录下，把 config.xml 复制到本地计算机上，然后在本地修改这个文件，取消注释这行配置，开启主机监听，方便通过 GUI 程序来访问。","position":{"start":{"line":48,"column":1,"offset":1374},"end":{"line":48,"column":105,"offset":1478}}}],"position":{"start":{"line":48,"column":1,"offset":1374},"end":{"line":48,"column":105,"offset":1478}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">&lt;</span>listen_host<span class=\"token operator\">></span><span class=\"token number\">0.0</span>.0.<span class=\"token operator\"><span class=\"token file-descriptor important\">0</span>&lt;</span>/listen_host<span class=\"token operator\">></span></code></pre></div>","position":{"start":{"line":50,"column":1,"offset":1480},"end":{"line":52,"column":4,"offset":1526}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"把原来的容器删了，加载在本地的配置文件，","position":{"start":{"line":54,"column":1,"offset":1528},"end":{"line":54,"column":21,"offset":1548}}}],"position":{"start":{"line":54,"column":1,"offset":1528},"end":{"line":54,"column":21,"offset":1548}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker run -d --name clickhouse-server --ulimit <span class=\"token assign-left variable\">nofile</span><span class=\"token operator\">=</span><span class=\"token number\">262144</span>:262144 --volume<span class=\"token operator\">=</span><span class=\"token environment constant\">$HOME</span>/clickhouse_database:/var/lib/clickhouse  -v ~/Documents/clickhouse/config.xml:/etc/clickhouse-server/config.xml yandex/clickhouse-server</code></pre></div>","position":{"start":{"line":56,"column":1,"offset":1550},"end":{"line":58,"column":4,"offset":1782}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"安装-tabix-来连接管理-clickhouse"},"children":[{"type":"element","tagName":"a","properties":{"href":"#%E5%AE%89%E8%A3%85-tabix-%E6%9D%A5%E8%BF%9E%E6%8E%A5%E7%AE%A1%E7%90%86-clickhouse","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"安装 Tabix 来连接管理 clickhouse","position":{"start":{"line":60,"column":5,"offset":1788},"end":{"line":60,"column":30,"offset":1813}}}],"position":{"start":{"line":60,"column":1,"offset":1784},"end":{"line":60,"column":30,"offset":1813}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Tabix 是这次我选用的管理工具，他是一个 web 站点，安装和使用都比较简单，甚至可以作为 clickhouse 的内嵌使用， UI 界面也同样优秀。 我在本机还是使用最方便的 docker 容器来跑。","position":{"start":{"line":62,"column":1,"offset":1815},"end":{"line":62,"column":104,"offset":1918}}}],"position":{"start":{"line":62,"column":1,"offset":1815},"end":{"line":62,"column":104,"offset":1918}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker run -d -p <span class=\"token number\">8080</span>:80 spoonest/clickhouse-tabix-web-client</code></pre></div>","position":{"start":{"line":64,"column":1,"offset":1920},"end":{"line":66,"column":4,"offset":1993}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"在本机访问 localhost:8080, 默认用户名 defaut，密码为空，","position":{"start":{"line":68,"column":1,"offset":1995},"end":{"line":68,"column":41,"offset":2035}}}],"position":{"start":{"line":68,"column":1,"offset":1995},"end":{"line":68,"column":41,"offset":2035}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"/static/assets/images/tabix-ui.png","alt":"tabix ui"},"children":[],"position":{"start":{"line":70,"column":1,"offset":2037},"end":{"line":70,"column":48,"offset":2084}}}],"position":{"start":{"line":70,"column":1,"offset":2037},"end":{"line":70,"column":48,"offset":2084}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"开始吧","position":{"start":{"line":72,"column":1,"offset":2086},"end":{"line":72,"column":4,"offset":2089}}}],"position":{"start":{"line":72,"column":1,"offset":2086},"end":{"line":72,"column":4,"offset":2089}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":72,"column":4,"offset":2089}}}}