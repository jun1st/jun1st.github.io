{"componentChunkName":"component---src-templates-blog-post-js","path":"/zookeeper-cluster-on-local/","result":{"data":{"site":{"siteMetadata":{"title":"fengd's zone","author":"fengd"}},"markdownRemark":{"id":"09484867-0888-5d51-9225-9f7e9a6b6605","html":"<p><strong>下载 Zookeeper</strong></p>\n<p>目前的版本是 3.4.13， 下载最新稳定版, 在本地配置一个为集群。</p>\n<p><strong>配置实例</strong></p>\n<p>把 zookeeper 解压到你的用户根目录下，创建三个实例配置文件</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">    <span class=\"token function\">cp</span> zoo_sample.cfg zoo-slave1.cfg\n    <span class=\"token function\">cp</span> zoo_sample.cfg zoo-slave2.cfg\n    <span class=\"token function\">cp</span> zoo_sample.cfg zoo-slave3.cfg</code></pre></div>\n<p>修改配置文件：</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">    <span class=\"token comment\"># sub zoo-slave1.cfg</span>\n\n    <span class=\"token comment\"># The number of milliseconds of each tick</span>\n    <span class=\"token assign-left variable\">tickTime</span><span class=\"token operator\">=</span><span class=\"token number\">2000</span>\n    <span class=\"token comment\"># The number of ticks that the initial</span>\n    <span class=\"token comment\"># synchronization phase can take</span>\n    <span class=\"token assign-left variable\">initLimit</span><span class=\"token operator\">=</span><span class=\"token number\">10</span>\n    <span class=\"token comment\"># The number of ticks that can pass between</span>\n    <span class=\"token comment\"># sending a request and getting an acknowledgement</span>\n    <span class=\"token assign-left variable\">syncLimit</span><span class=\"token operator\">=</span><span class=\"token number\">5</span>\n    <span class=\"token comment\"># the directory where the snapshot is stored.</span>\n    <span class=\"token comment\"># do not use /tmp for storage, /tmp here is just</span>\n    <span class=\"token comment\"># example sakes.</span>\n    <span class=\"token assign-left variable\">dataDir</span><span class=\"token operator\">=</span>/users/fengd/zk-data/slave1/data\n\n    <span class=\"token comment\"># the port at which the clients will connect</span>\n    <span class=\"token assign-left variable\">clientPort</span><span class=\"token operator\">=</span><span class=\"token number\">2181</span>\n\n    server.1<span class=\"token operator\">=</span>localhost:2887:3887\n    server.2<span class=\"token operator\">=</span>localhost:2888:3888\n    server.3<span class=\"token operator\">=</span>localhost:2889:3889\n\n    <span class=\"token comment\"># the maximum number of client connections.</span>\n    <span class=\"token comment\"># increase this if you need to handle more clients</span>\n    <span class=\"token comment\">#maxClientCnxns=60</span>\n    <span class=\"token comment\">#</span>\n    <span class=\"token comment\"># Be sure to read the maintenance section of the</span>\n    <span class=\"token comment\"># administrator guide before turning on autopurge.</span>\n    <span class=\"token comment\">#</span>\n    <span class=\"token comment\">#</span>\n    <span class=\"token comment\">#</span>\n    <span class=\"token comment\"># The number of snapshots to retain in dataDir</span>\n    <span class=\"token comment\">#autopurge.snapRetainCount=3</span>\n    <span class=\"token comment\"># Purge task interval in hours</span>\n    <span class=\"token comment\"># Set to \"0\" to disable auto purge feature</span>\n    <span class=\"token comment\">#autopurge.purgeInterval=1</span></code></pre></div>\n<p>配置文件都有详细的说明，需要创建的文件夹是 dataDir， 每个配置文件制定的文件目录都需要创建。</p>\n<p>此外还需要在对应的每个 dataDir 下创建每个 instance 对应的 id</p>\n<p><img src=\"https://cdn-images-1.medium.com/max/1600/1*e58a88PXmiUyj_Utvknjkw.png\"></p>\n<p>每个 myid 的值对应的是你的配置文件里， server.{id} 的值， 因为在一台机器上模拟一个伪集群，所以 clientPort 也都是不同的。</p>\n<p><strong>启动集群</strong></p>\n<p>通过不同的配置文件启动 instance</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">    <span class=\"token comment\"># cd ~/zookeeper/bin</span>\n\n    ./zkServer.sh start <span class=\"token punctuation\">..</span>/conf/zoo-slave1.cfg\n    ./zkServer.sh start <span class=\"token punctuation\">..</span>/conf/zoo-slave2.cfg\n    ./zkServer.sh start <span class=\"token punctuation\">..</span>/conf/zoo-slave3.cfg</code></pre></div>\n<p><strong>查看状态</strong></p>\n<p>查看是否启动成功</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">jps\n\n13120 QuorumPeerMain\n13174 QuorumPeerMain\n13191 Jps\n13147 QuorumPeerMain</code></pre></div>\n<p>产看每个实例的状态</p>\n<p><img src=\"https://cdn-images-1.medium.com/max/1600/1*ZUX4jl78J8b-aNk9XrVNVQ.png\"></p>\n<p>启动成功，装好了再来玩～</p>","timeToRead":2,"frontmatter":{"title":"在 Mac 本地搭建 Zookeeper 集群","date":"March 18, 2019","spoiler":"在 Mac 本地机器上搭建一个 Zookeeper 集群"},"fields":{"slug":"/zookeeper-cluster-on-local/","langKey":"en"}}},"pageContext":{"slug":"/zookeeper-cluster-on-local/","previous":{"fields":{"slug":"/sorting-algorithms-merge-sort/","langKey":"en","directoryName":"sorting-algorithms-merge-sort"},"frontmatter":{"title":"排序算法之合并排序"}},"next":{"fields":{"slug":"/spring-cloud-microservices-gateway/","langKey":"en","directoryName":"spring-cloud-microservices-gateway"},"frontmatter":{"title":"使用 Spring Cloud 构建微服务之Gateway"}},"translations":[],"translatedLinks":[]}}}